openapi: 3.0.0
info:
  title: WASAPhoto API
  version: 1.0.0
  description: WASAPhoto API for our university course on web and software architecture
tags:
  - name: login
  - name: user
  - name: comment
  - name: like
  - name: photo
  
security:
  - BearerAuth: []
  
  
paths:
  /session:
    post:
      tags: [login]
      summary: Logs in the user
      description: |
        If the user does not exist, it will be created,
        and an identifier is returned.
        If the user exists, the user identifier is returned.
      operationId: doLogin
      requestBody:
        description: User details
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: User's name
                  minLength: 3
                  maxLength: 50
                  pattern: "^[a-zA-Z0-9_]+$"  # Add a pattern for every string property
              description: General user object
                  
          
        required: true
      responses:
        '200':
          description: User log-in action successful
          content:
            application/json:
              schema:
                type: object
                description: The overall user object
                properties:
                  identifier:
                    type: string
                    description: A unique token for the user
                    minLength: 10
                    maxLength: 20
                    pattern: "^[a-zA-Z0-9_]+$"  # Add a pattern for every string property
                    
                

  /user:
    post:
      tags: [user]
      summary: Create User
      description: Create a new user.
      operationId: createUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: User's username
                  minLength: 4
                  maxLength: 30
                  pattern: "^[a-zA-Z0-9_]+$"
                password:
                  type: string
                  description: User's password
                  minLength: 8
                  maxLength: 50
                  pattern: "^[a-zA-Z0-9_]+$"
                email:
                  type: string
                  description: User's email
                  minLength: 5
                  maxLength: 100
                  pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$"  # Add email pattern
                birthday:
                  type: string
                  minLength: 7
                  maxLength: 10
                  description: User's birthday
                  pattern: "^d{4}-d{2}-d{2}$"  # Add birthday pattern
                security_question:
                  type: string
                  description: User's security question
                  minLength: 10
                  maxLength: 150
                  pattern: "^[a-zA-Z0-9_]+$"
                matricola:
                  type: integer
                  description: the students enrolment code
              description: An entire user as an object

      responses:
        '201':
          description: User created successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  userId:
                    type: string
                    minLength: 10
                    maxLength: 20
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: A unique user difentifier
                description: response to creating

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /users/{userId}:
    get:
      tags: [user]
      summary: Get User Profile
      description: Get the profile of a user.
      operationId: getUserProfile
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: A unique user identifier

      responses:
        '200':
          description: User profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  userProfile:
                    type: object
                    description: User's profile
                description: Exact response with the full user profile

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
                
                
    
  /users/{userId}/ban:
    post:
      tags: [user]
      summary: Ban User
      description: Ban a user.
      operationId: banUser
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique user identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  description: User ID to ban
                  minLength: 10
                  maxLength: 20
                  pattern: "^[a-zA-Z0-9_]+$"
              description: The user
      responses:
        '200':
          description: User banned successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: Returing a message about what user is banned
                description: The output for banning a user
  
        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
                
  /users/{userId}/stream:
    get:
      tags: [user]
      summary: Get My Stream
      description: Retrieve the user's stream.
      parameters:
          - name: userId
            in: path
            required: true
            schema:
              type: string
              minLength: 10
              maxLength: 20
              pattern: "^[a-zA-Z0-9_]+$"
              description: unique user identifier
      operationId: getMyStream
      
  
      responses:
        '200':
          description: User's stream retrieved successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  stream:
                    type: array
                    minItems: 0
                    maxItems: 100
                    description: all the stuff user needs for his for you page
                    items:
                      type: object
                      description: Stream item
                      properties:
                        itemProperty:
                          type: string
                          description: Description of item property
                          pattern: "^[a-zA-Z0-9_]+$"
                          minLength: 10
                          maxLength: 100
                description: The entire stream with info for the user
  
        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'             
  /users/{userId}/name:
    put:
      tags: [user]
      summary: Set My User Name
      description: Set the user's username.
      operationId: setMyUserName
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique user identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: New username
                  minLength: 4
                  maxLength: 30
                  pattern: "^[a-zA-Z0-9_]+$"
              description: Returning the user schema

      responses:
        '200':
          description: User's username updated successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    description: telling the user it worked
                    pattern: "^[a-zA-Z0-9_]+$"
                description: how the user looks

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'            
  
  /user/{userId}/unban:
    post:
      tags: [user]
      summary: Unban User
      description: Unban a user.
      operationId: unbanUser
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique user identifier
      requestBody:
        required: true
        content:
      
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  description: User ID to unban
                  minLength: 10
                  maxLength: 20
                  pattern: "^[a-zA-Z0-9_]+$"
              description: the entire user
  
      responses:
        '200':
          description: User unbanned successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: telling the user it worked
                description: the response for unbanning a user
  
        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
                
                
                
  /user/{userId}/follow:
    post:
      tags: [user]
      summary: Follow User
      description: Follow a user.
      operationId: followUser
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique identifier
          description: the id of the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  description: User ID to follow
                  minLength: 10
                  maxLength: 20
                  pattern: "^[a-zA-Z0-9_]+$"
              description: follow confirmation

      responses:
        '200':
          description: User followed successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: the success message
                description: The general response to following

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /user/{userId}/unfollow:
    post:
      tags: [user]
      summary: Unfollow User
      description: Unfollow a user.
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique identifier
          
      operationId: unfollowUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  description: User ID to unfollow
                  minLength: 10
                  maxLength: 20
                  pattern: "^[a-zA-Z0-9_]+$"
              description: response to unfollowing

      responses:
        '200':
          description: User unfollowed successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: unfollow message
                description: The response to unfollowing

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /photos/{photoId}/comments/:
    post:
      tags: [comment]
      summary: Comment on Photo
      description: Comment on a photo.
      parameters:
        - name: photoId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique user identifier
      operationId: commentPhoto
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                photoId:
                  type: string
                  minLength: 10
                  maxLength: 20
                  pattern: "^[a-zA-Z0-9_]+$"
                  description: an identifier for which photo to comment on
              description: the comment response

      responses:
        '201':
          description: Comment added to the photo successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: the message
                description: the object returned

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /comments/{commentId}:
    delete:
      tags: [comment]
      summary: Remove Comment from Photo
      description: Remove a comment from a photo.
      operationId: uncommentPhoto
      parameters:
        - name: commentId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: The comment ID

      responses:
        '200':
          description: Comment removed from the photo successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: Telling the user you removed the comment
                description: The entire response

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  photos/{photoId}/likes/:
    post:
      tags: [like, photo]
      summary: Like Photo
      description: Like a photo.
      operationId: likePhoto
      parameters:
        - name: photoId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: a unique user id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userID:
                  type: string
                  description: User ID
                  minLength: 10
                  maxLength: 20
                  pattern: "^[a-zA-Z0-9_]+$"
              description: Return message of liking

      responses:
        '200':
          description: Photo liked successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: "^[a-zA-Z0-9_]+$"
                    description: telling the user he liked
                description: the entire response

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'


     

  /likes/{likeId}:
    delete:
      tags: [like]
      summary: Unlike Photo
      description: Unlike a photo.
      operationId: unlikePhoto
      parameters:
        - name: likeId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9]{10,20}$' 
            minLength: 10
            maxLength: 100 # Pattern added
            description: unique like id
      responses:
        '200':
          description: Photo unliked successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: '^[a-zA-Z0-9]{10,20}$'
                    description: saying you unliked correctly
                description: response to unlikig

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  users/{userId}/photos/:
    post:
      tags: [photo]
      summary: Upload Photo
      description: Upload a photo.
      operationId: uploadPhoto
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            minLength: 10
            maxLength: 20
            pattern: "^[a-zA-Z0-9_]+$"
            description: Unique user ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                photo:
                  type: string
                  description: Base64-encoded image data
                  minLength: 50
                  maxLength: 500000
                  pattern: '^[a-zA-Z0-9]{10,20}$'
              description: response to uploading a photo
      responses:
        '201':
          description: Photo uploaded successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  photoId:
                    type: string
                    pattern: '^[a-zA-Z0-9]{10,20}$'  # Pattern added
                    minLength: 1000
                    maxLength: 10000
                    description: unique photo ID
                description: The response to uploading a photo succesfuly
                

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /photos/{photoId}:
    delete:
      tags: [photo]
      summary: Delete Photo
      description: Delete a photo.
      operationId: deletePhoto
      parameters:
        - name: photoId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9]{10,20}$'  # Pattern added
            minLength: 100
            maxLength: 1000
            description: Unique photo ID
      responses:
        '200':
          description: Photo deleted successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    minLength: 1
                    maxLength: 200
                    pattern: '^[a-zA-Z0-9]{10,20}$'
                    description: You uploaded succesfully
                description: Response to upload succesfully

        '401':
          description: Unauthorized. User authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          minLength: 1
          maxLength: 200
          pattern: '^[a-zA-Z0-9]{10,20}$'
          description: Describes the more specific error I am putting out
      description: The overall error object

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT 
